/*!
 *	Ok Tab Switcher
 *
 *	@author		Mitchell Petty <https://github.com/mpetty/ok-tab>
 *	@version	v1.4.1
 */
!function(a){"use strict";var b=function(b,c){var d=this;this.selector=a(b),this.settings=c,this.tabName=null,this.tabsViewed=[],this.el={},this.el.tabContent=a("."+this.settings.tabContentClass,this.selector),this.el.primaryNav=a("."+this.settings.tabNavClass,this.selector),this.el.secondaryNav=a(this.settings.connectedTabNav),this.el.tabs=a("> div, > .tab",this.el.tabContent),this.el.curTab=null,this.el.prevTab=null,this.el.nextTab=null,this.el.tabNav=[],this.el.primaryNav.length&&this.el.primaryNav.each(function(){d.el.tabNav.push(a(this))}),this.el.secondaryNav.length&&this.el.secondaryNav.each(function(){d.el.tabNav.push(a(this))}),this.Initialize.call(this)};b.prototype={Initialize:function(){var b=this;for(var c in this.el.tabNav)a("a",this.el.tabNav[c]).off(".okTab").on("click.okTab",function(c){var d=a(this).attr("data-tabname");c.preventDefault(),b.activate(d)});a("["+this.settings.tabDataLink+"]",this.el.tabContent).off(".okTab").on("click.okTab",function(c){var d=a(this).attr("data-tabname");c.preventDefault(),b.activate(d)}),this.build(),this.settings.saveTab&&""!==window.location.hash&&this.activate(window.location.hash.replace("#tab-",""),!0)},build:function(){var b=this;a("."+this.settings.activeClass,this.el.tabContent).length?(this.el.curTab=this.el.tabs.filter("."+this.settings.activeClass),this.el.tabs.not(this.el.curTab).hide()):(this.el.curTab=this.el.tabs.first(),this.el.curTab.addClass(this.settings.activeClass),this.el.tabs.not(":first").hide());for(var c in this.el.tabNav)a("."+this.settings.activeClass,this.el.tabNav[c]).length||a("li:first",this.el.tabNav[c]).addClass(this.settings.activeClass),a("a",this.el.tabNav[c]).each(function(c){var d=a(this).attr("href");-1!=d.indexOf("#")&&d.length>=2?(a(this).attr("data-tabname",a(this).attr("href").replace("#","")),a(this).parent().hasClass(b.settings.activeClass)&&(b.tabName=a(this).attr("href").replace("#",""))):(a(this).attr("data-tabname",c+1),a(this).parent().hasClass(b.settings.activeClass)&&(b.tabName=c+1))});a("> div, > .tab",this.el.tabContent).each(function(b){var c=a(this).attr("id");"undefined"!=typeof c&&c.length?a(this).attr("data-tabname",a(this).attr("id")):a(this).attr("data-tabname",b+1)}),this.el.tabs.each(function(){var c=a("["+b.settings.tabDataLink+"]",a(this)),d=a(this).next(),e=a(this).prev();if(c.length)for(var f=c.length-1;f>=0;f--){var g=a(c[f]).attr("href");-1!=g.indexOf("#")?a(c[f]).attr("data-tabname",a(c[f]).attr("href").replace("#","")):"next"===a(c[f]).attr(b.settings.tabDataLink)?d.length?a(c[f]).attr("data-tabname",d.attr("data-tabname")):a(c[f]).attr("data-tabname",b.el.tabs.first()):"prev"===a(c[f]).attr(b.settings.tabDataLink)&&(e.length?a(c[f]).attr("data-tabname",e.attr("data-tabname")):a(c[f]).attr("data-tabname",b.el.tabs.last()))}})},activate:function(b,c){var d=this,e=a("."+d.settings.activeClass,d.el.tabContent).attr("data-tabname"),f=d.el.tabContent.height(),g=a("> [data-tabname="+e+"]",d.el.tabContent),h=a("> [data-tabname="+b+"]",d.el.tabContent),i=null;if(h.length&&(this.settings.saveTab&&(window.location.hash=encodeURIComponent("tab-"+b)),0==d.el.tabContent.find(":animated").length&&e!=b)){d.el.nextTab=h,c||d.settings.beforeTabSwitch.call(d),d.tabName=b,a("li",d.el.tabNav).removeClass(d.settings.activeClass),d.el.tabs.removeClass(d.settings.activeClass),d.el.prevTab=g;for(var j in this.el.tabNav)a("li",this.el.tabNav[j]).removeClass(d.settings.activeClass),this.el.tabNav[j].find('[data-tabname="'+b+'"]').parent().addClass(d.settings.activeClass);c?g.hide(0,function(){h.show(0,function(){a(this).addClass(d.settings.activeClass),d.tabsViewed.push(b),d.el.curTab=a(this)})}):g.animate({opacity:"hide"},d.settings.animSpeed,function(){i=a("> div[data-tabname="+b+"]",d.el.tabContent).outerHeight(!0),d.el.tabContent.height(f),h.animate({opacity:"show"},d.settings.animSpeed,function(){a(this).addClass(d.settings.activeClass),d.settings.afterTabSwitch.call(d),d.tabsViewed.push(b),d.el.curTab=a(this)}),d.el.tabContent.animate({height:i},d.settings.animSpeed,function(){d.el.tabContent.css({height:"auto"})})})}}},a.fn.okTab=function(c){return this.each(function(){var d,e=a.extend(!0,{},a.fn.okTab.defaults,c);return this===document?a("["+e.tabDataAttr+"]").each(function(){e.connectedTabNav='[data-tabnav="'+a(this).attr(e.tabDataAttr)+'"]',d=new b(this,e)}):d=new b(this,e),this})},a.fn.okTab.defaults={tabDataLink:"data-tabs-link",tabDataAttr:"data-tabs",tabNavClass:"tabs",tabContentClass:"tabs-content",activeClass:"active",animSpeed:200,connectedTabNav:".tab-nav",saveTab:!0,beforeTabSwitch:a.noop,afterTabSwitch:a.noop}}(jQuery);